@using MaksimShimshon.GameManagePanel.Features.Lifecycle.Web.Components.ViewModels
@inherits WidgetComponentBase<PluginEntry, IServerControlViewModel>

    <MudCard>
        <MudCardMedia Image=@($"/_plugins/{BaseInfo.AssemblyName}/game_banner.png") Height="300" Style="background-position: top;background-repeat: no-repeat;" />
        <MudCardContent Class="justify-space-around mud-width-full py-6 px-6">
            @if (ViewModel.IsWaiting())
            {
                <MudAlert Severity=@Severity.Warning ContentAlignment=@HorizontalAlignment.Center NoIcon=true>
                    <MudProgressLinear Color="Color.Warning" Indeterminate="true" Class="my-1" />
                    <MudText Align=Align.Center>Awaiting for Server Info...</MudText>
                </MudAlert>
            }
            else if (ViewModel.GameInfo != default)
            {
                <MudText Typo=@Typo.h6>@ViewModel.GameInfo.Name</MudText>
                <MudDivider Class="my-1" Style="visibility: hidden;" />
                @if (ViewModel.GameInfo.SteamInfo != default)
                {
                    <MudChip T="string" Variant="Variant.Text" Color="Color.Info">@($"Steam: {ViewModel.GameInfo.SteamInfo.Steamid}")</MudChip>
                }
                @if (ViewModel.GameInfo.Modding)
                {
                    @if (ViewModel.GameInfo.SteamInfo != default && ViewModel.GameInfo.SteamInfo.HasModdingWorkshop)
                    {
                        <MudChip T="string" Icon=@Icons.Material.Filled.Check Variant="Variant.Text" Color="Color.Info">Steam Workshop</MudChip>
                    }
                    else
                    {
                        <MudChip T="string" Icon=@Icons.Material.Filled.Check Variant="Variant.Text" Color="Color.Info">Modding</MudChip>
                        <MudChip T="string" Icon=@Icons.Material.Filled.Stop Variant="Variant.Text" Color="Color.Error">Steam Workshop</MudChip>
                    }
                    @if (ViewModel.GameInfo.ManualModUpload != default)
                    {
                        <MudChip T="string" Icon=@Icons.Material.Filled.Stop Variant="Variant.Text" Color="Color.Warning">@($"Mod Upload Required")</MudChip>
                    }
                    else
                    {
                        <MudChip T="string" Icon=@Icons.Material.Filled.Check Variant="Variant.Text" Color="Color.Success">@($"Automatic Mod Download")</MudChip>
                    }
                }
            }

            @if (!ViewModel.IsWaiting())
            {
                <MudDivider Class="my-2" />
                @if (ViewModel.Transition == ServerTransition.Starting)
                {
                    <MudAlert Severity=@Severity.Success ContentAlignment=@HorizontalAlignment.Center NoIcon=true>
                        <MudProgressLinear Color="Color.Success" Indeterminate="true" Class="my-1" />
                        <MudText Align=Align.Center>Starting...</MudText>
                    </MudAlert>
                }
                else if (ViewModel.Transition == ServerTransition.Stopping)
                {
                    <MudAlert Severity=@Severity.Error ContentAlignment=@HorizontalAlignment.Center NoIcon=true>
                        <MudProgressLinear Color="Color.Error" Indeterminate="true" Class="my-1" />
                        <MudText Align=Align.Center>Stopping...</MudText>
                    </MudAlert>
                }
                else
                {
                    <MudFab Color="Color.Error"
                            StartIcon="@Icons.Material.Filled.Stop"
                            DropShadow="false" Size=@Size.Small
                            OnClick=@(() => ViewModel.Stop())
                            Disabled=@(ViewModel.IsStopped() || ViewModel.IsWaiting() || ViewModel.IsLoading) />

                    <MudFab Color="Color.Success"
                            StartIcon="@Icons.Material.Filled.PlayArrow"
                            DropShadow="false" OnClick=@(() => ViewModel.Start())
                            Disabled=@(ViewModel.IsRunning() || ViewModel.IsWaiting() || ViewModel.IsLoading) />
                }
            }

        </MudCardContent>
    </MudCard>
